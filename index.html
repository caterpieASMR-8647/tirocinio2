<!DOCTYPE html>
<html lang="en">

      <head>
            <meta charset="utf-8">
            <title>My first three.js app</title>
            <link rel="stylesheet" href="css/style.css"/>
      </head>
      
      <body>
            <div id="layout">
                  
                  <div id="canvasContainer">
                        <canvas id="render3d"></canvas>
                  </div>
                  
                  <div class="expandBox" hidden>
                        <button id="expandSideBar">Expand</button>
                  </div>

                  <div id="sidePanel" class="matrix">
                        <!-- ANIMATION SECTION -->
                        <div class="panelSection">
                              <div class="row" style="margin-bottom: 5px; align-items: center;">
                                    <div class="panelTitle" style="margin: 0;">Animation</div>
                                    <span style="flex: 1;"></span>
                                    <button id="collapseSideBar" hidden>Collapse</button>
                              </div>
                              <div class="subSection">
                                    <div class="inline">
                                          <button id="playButton">Play</button>
                                          <div class="progressWrapper" style="position: relative; width: 200px; height: 20px; ">
                                                <input id="progressBar" type="range" min="0" max="1" step="0.001" value="0" style="width:100%; position: absolute; top:0; left:0;">
                                                <div id="phaseMarkers"></div>
                                          </div>
                                          <button id="reverseButton">Reverse</button>
                                          <button id="boomerangButton">Boomerang</button>
                                    </div>

                                    <div class="inline" style="margin: 5px 0 5px;">
                                          <span>Animation Duration</span>
                                          <div class="progressWrapper" style="position: relative;">
                                                <input id="animationDurationSlider" type="range" min="1" max="10" step="1" value="3" style="width:100%; position: absolute; top:0; left:0;">
                                          </div>
                                          <span id="animationDurationText">3 sec</span>
                                    </div>

                                    <div class="inline">
                                          <button id="stillshotBtn">Toggle Stillshot</button>
                                          <div class="progressWrapper" style="position: relative;">
                                                <input id="stillshotSlider" type="range" min="1" max="10" value="5" style="width:100%; position: absolute; top:0; left:0;">
                                          </div>
                                          <span id="stillshotText">5 mesh</span>
                                    </div>
                        
                                    <div class="hidden" id="orderContainer">
                                          <div style="font-size: large; margin: 5px;">Transformations Order</div>
                                          <div class="order-item" draggable="true" data-key="T">Translation</div>
                                          <div class="order-item" draggable="true" data-key="R">Rotation</div>
                                          <div class="order-item" draggable="true" data-key="S">Scale</div>
                                    </div>
                                    
                                    <div id="indipendentContainer" hidden>
                                          <input type="checkbox" id="indipendentTransforms">
                                          <label for="indipendentTransforms">Indipendent Transformations</label>
                                    </div>
                              </div>
                        </div>

                        <!-- CAMERA SECTION -->
                        <div class="panelSection">
                              <div class="panelTitle">Camera</div>

                              <div class="row">
                                    <div class="subSection" style="width: 50%;">
                                          <div class="subTitle">Preset Views</div>
                                          <div class="buttonRow">
                                                <button class="active" id="frontView">Front</button>
                                                <button id="leftView">Left</button>
                                                <button id="rightView">Right</button>
                                                <button id="topView">Top</button>
                                          </div>
                                    </div>
                                    <div class="subSection" style="width: 50%;">
                                          <div class="subTitle">View</div>
                                          <div class="buttonRow">
                                                <button id="perspectiveChange">2D</button>
                                          </div>
                                    </div>
                              </div>
                        </div>

                        <!-- SCENE SECTION -->
                        <div class="panelSection">
                              <div class="panelTitle">Scene</div>
                              <div class="row">
                                    <div class="subSection" style="width: 50%;">
                                          <div class="subTitle">Reset</div>
                                          
                                          <div class="buttonRow">
                                                Mesh1:
                                                <button data-target="mesh1" data-action="resetAll">All</button>
                                                <button data-target="mesh1" data-action="resetPosition">Position</button>
                                                <button data-target="mesh1" data-action="resetRotation">Rotation</button>
                                                <button data-target="mesh1" data-action="resetScale">Scale</button>
                                          </div>

                                          <div class="buttonRow">
                                                Mesh2:
                                                <button data-target="mesh2" data-action="resetAll">All</button>
                                                <button data-target="mesh2" data-action="resetPosition">Position</button>
                                                <button data-target="mesh2" data-action="resetRotation">Rotation</button>
                                                <button data-target="mesh2" data-action="resetScale">Scale</button>
                                          </div>

                                    </div>

                                    <div class="subSection" style="width: 50%;">
                                          <div class="subTitle">Problematic Setups</div>
                                          <div class="buttonRow">
                                                <div class="presetSetup" id="matrixSetup">
                                                      <button data-preset="matrix.shear">Shear</button>
                                                </div>
                                                <div class="presetSetup hidden" id="eulerSetup">
                                                      <button data-preset="euler.gimbalLock">Gimbal Lock</button>
                                                </div>
                                                <div class="presetSetup hidden" id="axisangleSetup">
                                                      <button data-preset="axisangle.axisAmbiguity">Axis Ambiguity</button>
                                                </div>
                                                <div class="presetSetup hidden" id="quatSetup">
                                                      <button data-preset="quat.sp">Shortest Path</button>
                                                </div>
                                                <div class="presetSetup hidden" id="dualquatSetup">
                                                      <button data-preset="dualquat.volumePreservation">Volume Preservation</button>
                                                </div>
                                          </div>
                                    </div>
                              </div>
                              
                              <div class="row">
                                    <div class="subSection" style="width: 50%;">
                                          <div class="subTitle">Model</div>
                                          <div class="inline">
                                                <select class="buttonRow" id="modelSelector">
                                                      <option value="plane2.fbx" checked>Plane</option>
                                                      <option value="model2">Tank</option>
                                                      <option value="J10B-TSF.fbx">Mech</option>
                                                </select>
                                                <div class="progressWrapper" style="position: relative;">
                                                      <input id="opacitySlider" type="range" min="0" max="1" step="0.05" value="0.25" style="width:100%; position: absolute; top:0; left:0;">
                                                </div>
                                                <span id="opacityText">25% opacity</span>
                                          </div>
                                    </div>

                                    <div class="subSection" style="width: 50%;">
                                          <div class="subTitle">UI</div>
                                          <div class="buttonRow">
                                                <button id="gizmoToggle" class="rightButton">Toggle Gizmos</button>
                                          </div>
                                    </div>
                              </div>
                        </div>

                        <!-- MODE SECTION — TABS -->
                        <div class="panelSection">
                              <div class="panelTitle">Transform Mode</div>

                              <div id="modeTabs">
                                    <div class="tab active" data-tab="matrix">Matrix</div>
                                    <div class="tab" data-tab="euler">Euler Angles</div>
                                    <div class="tab" data-tab="axisangle">Axis-Angle</div>
                                    <div class="tab" data-tab="quat">Quaternion</div>
                                    <div class="tab" data-tab="dualquat">Dual Quaternion</div>
                              </div>

                              <div id="modeContent">
                                    <!-- You will fill this later -->
                                    <div class="tabContent" data-tab="matrix">
                                          <div class="tabTop">
                                                <div class="tabMesh" id="matrixA"></div>
                                                <div class="tabMesh" id="matrixB"></div>
                                          </div>
                                          <div class="tabMid">
                                                <div class="tabMod" id="matrixMod">
                                                      <div class="modTitle">
                                                            <b>Modifiers:</b><br>
                                                      </div>
                                                      <div class="lastModEntry">
                                                            No Modifiers<br>
                                                      </div>
                                                </div>
                                          </div>
                                          <div class="tabBot">
                                                <div class="tabMix" id="matrixMix"></div>
                                                <div class="tabSetM" id="matrixSetM"></div>
                                          </div>
                                    </div>
                                    <div class="tabContent hidden" data-tab="euler">
                                          <div class="tabTop">
                                                <div class="tabMesh" id="eulerA"></div>
                                                <div class="tabMesh" id="eulerB"></div>
                                          </div>
                                          <div class="tabMid">
                                                <div class="tabMod" id="eulerMod">
                                                      <div class="modTitle">
                                                            <b>Modifiers:</b><br>
                                                      </div>
                                                      <div class="modEntry">
                                                            <input type="checkbox" id="eulerSP" value>Shortest Path
                                                      </div>
                                                      <div class="modEntry">
                                                            <b>Euler rotation mode:</b>
                                                            <input type="radio" name="eulerRot" value="parallel" checked> Parallel Interpolation
                                                            <input type="radio" name="eulerRot" value="series"> Series Rotation
                                                      </div>
                                                      <div class="modEntry">
                                                            <div class="inline">
                                                                  <label>Transform Order:</label>
                                                                  <select id="eulerTransformOrder">
                                                                        <option value="TRS">Translate → Rotate → Scale (Default)</option>
                                                                        <option value="TSR">Translate → Scale → Rotate</option>
                                                                        <option value="RTS">Rotate → Translate → Scale</option>
                                                                        <option value="RST">Rotate → Scale → Translate</option>
                                                                        <option value="STR">Scale → Translate → Rotate</option>
                                                                        <option value="SRT">Scale → Rotate → Translate</option>
                                                                  </select>
                                                            </div>
                                                      </div>
                                                      <div class="modEntry">
                                                            <div class="inline">
                                                                  <label>Rotation Order:</label>
                                                                  <select id="eulerRotationOrder">
                                                                        <optgroup label="Standard">
                                                                              <option value="XYZ">XYZ</option>
                                                                              <option value="XZY">XZY</option>
                                                                              <option value="YXZ">YXZ</option>
                                                                              <option value="YZX">YZX</option>
                                                                              <option value="ZXY">ZXY</option>
                                                                              <option value="ZYX">ZYX</option>
                                                                        </optgroup>
                                                                              <optgroup label="Repeated">
                                                                              <option value="XYX">XYX</option>
                                                                              <option value="XZX">XZX</option>
                                                                              <option value="YXY">YXY</option>
                                                                              <option value="YZY">YZY</option>
                                                                              <option value="ZXZ">ZXZ</option>
                                                                              <option value="ZYZ">ZYZ</option>
                                                                        </optgroup>
                                                                  </select>
                                                            </div>
                                                      </div>
                                                      <div class="lastModEntry">
                                                            <b>Scale:</b>
                                                            <input type="radio" name="eulerScale" value="arithmetic" checked> Arithmetic
                                                            <input type="radio" name="eulerScale" value="geometric"> Geometric
                                                      </div>
                                                </div>
                                          </div>
                                          <div class="tabBot">
                                                <div class="tabMix" id="eulerMix"></div>
                                                <div class="tabSetM" id="eulerSetM"></div>
                                          </div>
                                    </div>
                                    <div class="tabContent hidden" data-tab="axisangle">
                                          <div class="tabTop">
                                                <div class="tabMesh" id="axisangleA"></div>
                                                <div class="tabMesh" id="axisangleB"></div>
                                          </div>
                                          <div class="tabMid">
                                                <div class="tabMod" id="axisangleMod">
                                                      <div class="modTitle">
                                                            <b>Modifiers:</b><br>
                                                      </div>
                                                      <div class="modEntry">
                                                            <input type="checkbox" id="axisangleSP" value>Shortest Path
                                                      </div>
                                                      <div class="modEntry hidden noTabHide" id="axisangleSPType">
                                                            <input type="radio" name="axisangleSPType" value="perAngle" checked> Per Angle
                                                            <input type="radio" name="axisangleSPType" value="global"> Global
                                                      </div>
                                                      <div class="modEntry">
                                                            <b>Type of Interpolation:</b>
                                                            <input type="radio" name="axisangleInterp" value="nlerp" checked> N-Lerp
                                                            <input type="radio" name="axisangleInterp" value="slerp"> S-Lerp
                                                      </div>
                                                      <div class="modEntry">
                                                            <div class="inline">
                                                                  <label>Transform Order:</label>
                                                                  <select id="axisangleTransformOrder">
                                                                        <option value="TRS">Translate → Rotate → Scale (Default)</option>
                                                                        <option value="TSR">Translate → Scale → Rotate</option>
                                                                        <option value="RTS">Rotate → Translate → Scale</option>
                                                                        <option value="RST">Rotate → Scale → Translate</option>
                                                                        <option value="STR">Scale → Translate → Rotate</option>
                                                                        <option value="SRT">Scale → Rotate → Translate</option>
                                                                  </select>
                                                            </div>
                                                      </div>
                                                      <div class="lastModEntry">
                                                            <b>Scale:</b>
                                                            <input type="radio" name="axisangleScale" value="arithmetic" checked> Arithmetic
                                                            <input type="radio" name="axisangleScale" value="geometric"> Geometric
                                                      </div>
                                                </div>
                                          </div>
                                          <div class="tabBot">
                                                <div class="tabMix" id="axisangleMix"></div>
                                                <div class="tabSetM" id="axisangleSetM"></div>
                                          </div>
                                    </div>
                                    <div class="tabContent hidden" data-tab="quat">
                                          <div class="tabTop">
                                                <div class="tabMesh" id="quatA"></div>
                                                <div class="tabMesh" id="quatB"></div>
                                          </div>
                                          <div class="tabMid">
                                                <div class="tabMod" id="quatMod">
                                                      <div class="modTitle">
                                                            <b>Modifiers:</b><br>
                                                      </div>
                                                      <div class="modEntry">
                                                            <input type="checkbox" id="quatSP" checked>Shortest Path
                                                      </div>
                                                      <div class="modEntry">
                                                            <b>Type of Interpolation:</b>
                                                            <input type="radio" name="quatInterp" value="nlerp" checked> N-Lerp
                                                            <input type="radio" name="quatInterp" value="slerp"> S-Lerp
                                                            <input type="radio" name="quatInterp" value="lerp"> Lerp
                                                      </div>
                                                      <div class="modEntry">
                                                            <div class="inline">
                                                                  <label>Transform Order:</label>
                                                                  <select id="quatTransformOrder">
                                                                        <option value="TRS">Translate → Rotate → Scale (Default)</option>
                                                                        <option value="TSR">Translate → Scale → Rotate</option>
                                                                        <option value="RTS">Rotate → Translate → Scale</option>
                                                                        <option value="RST">Rotate → Scale → Translate</option>
                                                                        <option value="STR">Scale → Translate → Rotate</option>
                                                                        <option value="SRT">Scale → Rotate → Translate</option>
                                                                  </select>
                                                            </div>
                                                      </div>
                                                      <div class="lastModEntry">
                                                            <b>Scale:</b>
                                                            <input type="radio" name="quatScale" value="arithmetic" checked> Arithmetic
                                                            <input type="radio" name="quatScale" value="geometric"> Geometric
                                                      </div>
                                                </div>
                                          </div>
                                          <div class="tabBot">
                                                <div class="tabMix" id="quatMix"></div>
                                                <div class="tabSetM" id="quatSetM"></div>
                                          </div>
                                    </div>
                                    <div class="tabContent hidden" data-tab="dualquat">
                                          <div class="tabTop">
                                                <div class="tabMesh" id="dualquatA"></div>
                                                <div class="tabMesh" id="dualquatB"></div>
                                          </div>
                                          <div class="tabMid">
                                                <div class="tabMod" id="dualquatMod">
                                                      <div class="modTitle">
                                                            <b>Modifiers:</b><br>
                                                      </div>
                                                      <div class="modEntry">
                                                            <input type="checkbox" id="dualquatSP" checked>Shortest Path
                                                      </div>
                                                      <div class="modEntry" id="dualquatNormType" checked>
                                                            <input type="checkbox" id="dualquatNormPrimal" checked> Normalize Primal
                                                            <input type="checkbox" id="dualquatNormDual" checked> Normalize Dual
                                                      </div>
                                                      <div class="modEntry">
                                                            <input type="checkbox" id="dualquatReHortDual" checked>Re-Hortogonalize Dual
                                                      </div>
                                                      <div class="modEntry">
                                                            <div class="inline">
                                                                  <label>Transform Order:</label>
                                                                  <select id="dualquatTransformOrder">
                                                                        <option value="TRS">Translate + Rotate → Scale (Default)</option>
                                                                        <option value="STR">Scale → Translate + Rotate</option>
                                                                  </select>
                                                            </div>
                                                      </div>
                                                      <div class="lastModEntry">
                                                            <b>Scale:</b>
                                                            <input type="radio" name="dualquatScale" value="arithmetic" checked> Arithmetic
                                                            <input type="radio" name="dualquatScale" value="geometric"> Geometric
                                                      </div>
                                                </div>
                                          </div>
                                          <div class="tabBot">
                                                <div class="tabMix" id="dualquatMix"></div>
                                                <div class="tabSetM" id="dualquatSetM"></div>
                                          </div>
                                    </div>
                              </div>
                        </div>

                        <!-- LEGEND SECTION -->
                        <div class="panelSection" style="padding: 0px; margin: 0px; border: 0px;">
                              <div class="panelTitle toggleable">
                                    <span>Legend</span>
                                    <button id="legendToggle">Show / Hide</button>
                              </div>

                              <div id="legendContent" hidden>
                                    <div class="subSection">
                                          <div style="padding: 5px;">Legend content here...</div>
                                    </div>
                              </div>
                        </div>
                  </div>

            </div>


            <script type="importmap">
            {
                  "imports": {
                        "three": "../three/three/build/three.module.js",
                        "three/addons/": "../three/three/examples/jsm/"
                  }
            }
            </script>
            <script type="module" src="js/main.js"></script>
      </body>

</html>